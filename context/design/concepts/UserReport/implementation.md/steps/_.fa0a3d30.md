---
timestamp: 'Sat Oct 18 2025 12:21:13 GMT-0400 (Eastern Daylight Time)'
parent: '[[../20251018_122113.69f5c94b.md]]'
content_id: fa0a3d304e247de08cd2bedae6cb0b83c82275899c052ecb157f67dc4dc075e6
---

# Concept UserReport

**concept** UserReport \[User, Queue]

**purpose** Enable users to submit real-time data about queue conditions, which, once validated, can improve prediction accuracy and trustworthiness.

**principle** If a user submits a report about a queue's condition, and that report is later processed and marked as validated, then the system's queue predictions will be updated to reflect the most accurate real-time data, thus fulfilling the goal of improving prediction accuracy.

**state**

a set of Reports with
id: Report // The unique identifier for this specific report
user: User // Reference to the user who submitted the report (generic type)
queue: Queue // Reference to the queue the report is about (generic type)
timestamp: DateTime // When the report was submitted
estimatedPeopleInLine: Optional Number // User's estimate of people in line
currentWaitTime: Optional Number // User's reported current wait time
entryOutcome: Optional Enum ('entered', 'denied', 'left') // User's outcome after queueing
validated: Boolean = false // True if the report has been confirmed as accurate

**actions**

***

**submitReport (user: User, queue: Queue, estimatedPeopleInLine: Optional Number, currentWaitTime: Optional Number, entryOutcome: Optional Enum('entered', 'denied', 'left')): (report: Report)**

**requires** true // The concept treats `User` and `Queue` as polymorphic identifiers; their existence or verification is handled by syncs involving other concepts.

**effects** creates a new `Report` entity (let's call it `r`) in the concept's state such that:
`r.user` := `user`
`r.queue` := `queue`
`r.timestamp` := the current `DateTime`
`r.estimatedPeopleInLine` := `estimatedPeopleInLine`
`r.currentWaitTime` := `currentWaitTime`
`r.entryOutcome` := `entryOutcome`
`r.validated` := `false`
returns `r` (the identifier of the newly created report)

***

**setReportValidationStatus (report: Report, isValid: Boolean): Empty**
**setReportValidationStatus (report: Report, isValid: Boolean): (error: String)**

**requires** the `report` (identified by its `Report` ID) must exist in the concept's state.

**effects** updates the `validated` property of the specified `report` such that:
`report.validated` := `isValid`
On success, returns an empty dictionary. If the report does not exist, returns an error string.

***

**queries**

\_getReport (report: Report): (reportDetails: {id: Report, user: User, queue: Queue, timestamp: DateTime, estimatedPeopleInLine: Optional Number, currentWaitTime: Optional Number, entryOutcome: Optional Enum, validated: Boolean})
\_getReportsForQueue (queue: Queue): (reports: Array<{id: Report, user: User, timestamp: DateTime, estimatedPeopleInLine: Optional Number, currentWaitTime: Optional Number, entryOutcome: Optional Enum, validated: Boolean}>)
\_getValidatedReportsForQueue (queue: Queue): (reports: Array<{id: Report, user: User, timestamp: DateTime, estimatedPeopleInLine: Optional Number, currentWaitTime: Optional Number, entryOutcome: Optional Enum, validated: Boolean}>)

***

### Rationale for changes:

1. **Concept Name and Type Parameters:**
   * Changed to `UserReport [User, Queue]` to explicitly define the generic type parameters (`User` and `Queue`) for entities that are external to this concept (users and queues). This emphasizes polymorphism and reusability, allowing `UserReport` to be used with any user or queue identification system.

2. **Purpose:**
   * Merged and refined the two initial purpose statements into one that is more **need-focused** (for users to submit data), **specific** (about queue conditions, improving predictions), and **evaluable** (accuracy and trustworthiness are measurable outcomes). The original second purpose was more of an *overall system goal* rather than the specific purpose of *this concept*.

3. **Principle:**
   * A new principle has been added to provide an **archetypal scenario** that clearly demonstrates how the concept fulfills its purpose. It follows the "If X, then Y, fulfilling Z" structure and includes the crucial validation step, differentiating it from a simpler "report submission" concept. It highlights the *utility* of the concept.

4. **State:**
   * Renamed the entity `UserReports` to `Reports` to clearly distinguish the concept (UserReport) from the entity it manages (Report).
   * `reportID`, `userID`, `queueID` have been updated to `id: Report`, `user: User`, `queue: Queue` respectively, to align with the use of generic type parameters and the recommended `ID` pattern for entities.
   * Added a default value `false` to `validated` as per convention for initial state.
   * Clarified `Optional` for fields that may not always be present in a submission.

5. **Actions:**
   * **`submitReport`**:
     * Arguments now use the generic types `User` and `Queue`.
     * The `requires` clause has been set to `true`. This is a critical change reflecting **Concept Independence** and **Polymorphism**. The `UserReport` concept does not inherently know or care if `User` or `Queue` IDs are "verified" or "exist" in other systems; it treats them as opaque identifiers. Any such verification would occur *before* calling `submitReport` via a `sync` that orchestrates interactions with `UserAuthentication` or `QueueManagement` concepts.
     * The `effects` clause now strictly describes changes to *this concept's state*. The mention of "Information is passed to PredictionEngine for processing" has been removed because this is an interaction with another system/concept, which should be handled by a **synchronization (sync)** rule, not as an internal effect of `UserReport`. This adheres to the **Completeness of functionality** rule for concepts.
     * The return type is `(report: Report)`, returning the identifier of the newly created report.
   * **`validateReport` (renamed to `setReportValidationStatus`)**:
     * Renamed to `setReportValidationStatus` to more accurately reflect its role: it *sets* the validation status, rather than *performing* the complex validation logic itself. The "cross-checking with other reports" is a complex behavior that would likely be orchestrated by a `sync` rule (possibly involving other `UserReport` data or a `Prediction` concept) which then calls `setReportValidationStatus`. This maintains **Separation of Concerns** and **Completeness of functionality** for `UserReport`.
     * Arguments now use the generic type `Report`.
     * Modified to return `Empty` on success or `(error: String)` on failure, aligning with the guidelines for handling results and errors.
     * The `effects` clearly state the state change (`report.validated := isValid`).

6. **Queries:**
   * Added explicit query definitions for common ways to retrieve reports (`_getReport`, `_getReportsForQueue`, `_getValidatedReportsForQueue`). While simple state reads might be implicit, these represent "significant and non-trivial observations" that are useful to define for clarity and for testing.
